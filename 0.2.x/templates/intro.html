<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Templates and Routing - Perseus Book</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../what-is-perseus.html"><strong aria-hidden="true">1.1.</strong> What is Perseus?</a></li><li class="chapter-item expanded "><a href="../hello-world.html"><strong aria-hidden="true">1.2.</strong> Hello World!</a></li></ol></li><li class="chapter-item expanded "><a href="../second-app.html"><strong aria-hidden="true">2.</strong> Your Second App</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Reference</li><li class="chapter-item expanded "><a href="../define-app.html"><strong aria-hidden="true">3.</strong> define_app!</a></li><li class="chapter-item expanded "><a href="../views.html"><strong aria-hidden="true">4.</strong> Writing Views</a></li><li class="chapter-item expanded "><a href="../debugging.html"><strong aria-hidden="true">5.</strong> Debugging</a></li><li class="chapter-item expanded "><a href="../templates/intro.html" class="active"><strong aria-hidden="true">6.</strong> Templates and Routing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../templates/metadata-modification.html"><strong aria-hidden="true">6.1.</strong> Modifying the &lt;head&gt;</a></li><li class="chapter-item expanded "><a href="../templates/setting-headers.html"><strong aria-hidden="true">6.2.</strong> Modifying HTTP Headers</a></li></ol></li><li class="chapter-item expanded "><a href="../error-pages.html"><strong aria-hidden="true">7.</strong> Error Pages</a></li><li class="chapter-item expanded "><a href="../static-content.html"><strong aria-hidden="true">8.</strong> Static Content</a></li><li class="chapter-item expanded "><a href="../i18n/intro.html"><strong aria-hidden="true">9.</strong> Internationalization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../i18n/defining.html"><strong aria-hidden="true">9.1.</strong> Defining Translations</a></li><li class="chapter-item expanded "><a href="../i18n/using.html"><strong aria-hidden="true">9.2.</strong> Using Translations</a></li><li class="chapter-item expanded "><a href="../i18n/translations-managers.html"><strong aria-hidden="true">9.3.</strong> Translations Managers</a></li><li class="chapter-item expanded "><a href="../i18n/other-engines.html"><strong aria-hidden="true">9.4.</strong> Other Translation Engines</a></li></ol></li><li class="chapter-item expanded "><a href="../strategies/intro.html"><strong aria-hidden="true">10.</strong> Rendering Strategies</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../strategies/build-state.html"><strong aria-hidden="true">10.1.</strong> Build State</a></li><li class="chapter-item expanded "><a href="../strategies/build-paths.html"><strong aria-hidden="true">10.2.</strong> Build Paths</a></li><li class="chapter-item expanded "><a href="../strategies/request-state.html"><strong aria-hidden="true">10.3.</strong> Request State</a></li><li class="chapter-item expanded "><a href="../strategies/revalidation.html"><strong aria-hidden="true">10.4.</strong> Revalidation</a></li><li class="chapter-item expanded "><a href="../strategies/incremental.html"><strong aria-hidden="true">10.5.</strong> Incremental Generation</a></li><li class="chapter-item expanded "><a href="../strategies/amlagamation.html"><strong aria-hidden="true">10.6.</strong> State Amalgamation</a></li></ol></li><li class="chapter-item expanded "><a href="../cli.html"><strong aria-hidden="true">11.</strong> CLI</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ejecting.html"><strong aria-hidden="true">11.1.</strong> Ejecting</a></li></ol></li><li class="chapter-item expanded "><a href="../config-managers.html"><strong aria-hidden="true">12.</strong> Config Managers</a></li><li class="chapter-item expanded "><a href="../testing/intro.html"><strong aria-hidden="true">13.</strong> Testing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../testing/checkpoints.html"><strong aria-hidden="true">13.1.</strong> Checkpoints</a></li><li class="chapter-item expanded "><a href="../testing/fantoccini-basics.html"><strong aria-hidden="true">13.2.</strong> Fantoccini Basics</a></li><li class="chapter-item expanded "><a href="../testing/manual.html"><strong aria-hidden="true">13.3.</strong> Manual Testing</a></li></ol></li><li class="chapter-item expanded "><a href="../styling.html"><strong aria-hidden="true">14.</strong> Styling</a></li><li class="chapter-item expanded "><a href="../deploying/intro.html"><strong aria-hidden="true">15.</strong> Deploying</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deploying/exporting.html"><strong aria-hidden="true">15.1.</strong> Static Exporting</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.2.</strong> Server Deployment</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.3.</strong> Serverless Deployment</div></li></ol></li><li class="chapter-item expanded "><a href="../updating.html"><strong aria-hidden="true">16.</strong> Migrating from v0.1.x</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Advanced</li><li class="chapter-item expanded "><a href="../advanced/intro.html"><strong aria-hidden="true">17.</strong> Under the Hood</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../advanced/arch.html"><strong aria-hidden="true">17.1.</strong> Architecture</a></li><li class="chapter-item expanded "><a href="../advanced/initial-loads.html"><strong aria-hidden="true">17.2.</strong> Initial Loads</a></li><li class="chapter-item expanded "><a href="../advanced/subsequent-loads.html"><strong aria-hidden="true">17.3.</strong> Subsequent Loads</a></li><li class="chapter-item expanded "><a href="../advanced/routing.html"><strong aria-hidden="true">17.4.</strong> Routing</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Perseus Book</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="templates"><a class="header" href="#templates">Templates</a></h1>
<p>At the core of Perseus is its template system, which is how you'll define every page you'll ever build! However, it's important to understand a few of the nuances of this system so that you can build the best apps possible.</p>
<h2 id="templates-vs-pages"><a class="header" href="#templates-vs-pages">Templates vs Pages</a></h2>
<p>In Perseus, the idea of a <em>template</em> is very different to the idea of a <em>page</em>.</p>
<p>A <em>page</em> corresponds to a URL in your app, like the about page, the landing page, or an individual blog post.</p>
<p>A <em>template</em> can generate <em>many</em> pages or only one by using <em>rendering strategies</em>.</p>
<p>The best way to illustrate this is with the example of a simple blog, with each page stored in something like a CMS (content management system). This app would only need two templates (in addition to a landing page, an about page, etc.): <code>blog</code> and <code>post</code>. For simplicity, we'll put the list of all blog posts in <code>blog</code>, and then each post will have its own URL under <code>post</code>.</p>
<p>The <code>blog</code> template will be rendered to <code>/blog</code>, and will only use the <em>build state</em> strategy, fetching a list of all our posts from the CMS every time the blog is rebuilt (or you could use revalidation and incremental generation to mean you never have to rebuild at all, but that's beyond the scope of this section). This template only generates one page, providing it the properties of the list of blog posts. So, in this case, the <code>blog</code> template has generated the <code>/blog</code> page.</p>
<p>The <code>post</code> template is more complex, and it will generate <em>many</em> pages, one for each blog post. This would probably use the <em>build paths</em> strategy, which lets you fetch a list of blog posts from the CMS at build-time and invoke <em>build state</em> for each of them, which would then get their content, metadata, etc. Thus, the <code>post</code> template generates many pages.</p>
<p>Hopefully that explains the difference between a template and a post. This is a somewhat unintuitive part of Perseus, but it should be clear in the documentation what the difference is. Note however that old versions of the examples in the repository used these terms interchangeably, when they used to be the same. If you see any remaining ambiguity in the docs, please <a href="https://github.com/arctic-hen7/perseus/issues/new/choose">open an issue</a>!</p>
<h2 id="defining-a-template"><a class="header" href="#defining-a-template">Defining a Template</a></h2>
<p>You can define a template like so (taken from <a href="https://github.com/arctic-hen7/perseus/blob/main/examples/basic/src/templates/about.rs">the basic example</a>'s about page):</p>
<pre><pre class="playground"><code class="language-rust no_run no_playground edition2018">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use perseus::Template;
use std::rc::Rc;
use sycamore::prelude::{component, template, GenericNode, Template as SycamoreTemplate};

#[component(AboutPage&lt;G&gt;)]
pub fn about_page() -&gt; SycamoreTemplate&lt;G&gt; {
    template! {
        p { &quot;About.&quot; }
    }
}

pub fn get_template&lt;G: GenericNode&gt;() -&gt; Template&lt;G&gt; {
    Template::new(&quot;about&quot;)
        .template(template_fn())
        .head(head_fn())
}

pub fn template_fn&lt;G: GenericNode&gt;() -&gt; perseus::template::TemplateFn&lt;G&gt; {
    Rc::new(|_| {
        template! {
            AboutPage()
        }
    })
}

pub fn head_fn() -&gt; perseus::template::HeadFn {
    Rc::new(|_| {
        template! {
            title { &quot;About Page | Perseus Example – Basic&quot; }
        }
    })
}
<span class="boring">}
</span></code></pre></pre>
<p>It's seen as convention in Perseus to define each template in its own file, which should expose a <code>get_template()</code> file. Note that this is just convention, and as long as you get an instance of <code>Template&lt;G&gt;</code> to the <code>define_app!</code> macro, it really doesn't matter. That said, using community conventions makes your code easier to understand and debug for others.</p>
<p>There's a list of all the methods available on a template <a href="https://docs.rs/perseus/0.2/perseus/template/struct.Template.html#implementations">here</a>, along with explanations of what they all do. Technically, you could just define a template without calling any of these, but that would just render a blank page, which would probably be useless.</p>
<h2 id="routing"><a class="header" href="#routing">Routing</a></h2>
<p>Perseus' routing system is basically invisible, there's no router that you need to work with, nor any place for you to define explicit routes. Instead, Perseus automatically infers the routes for all your templates and the pages they generate from their names!</p>
<p>The general rule is this: a template called <code>X</code> will be rendered at <code>/X</code>. Simple. What's more difficult to understand is what we call <em>template path domains</em>, which is the system that makes route inference possible. <strong>A template can only ever generate pages within the scope of its root path.</strong> Its root path is its name. In the example of a template called <code>X</code>, it can render <code>/X/Y</code>, <code>/X/Y/Z</code>, etc., but it can <em>never</em> render <code>/A</code>.</p>
<p>To generate paths within a template's domain, you can use the <em>build paths</em> and <em>incremental generation</em> strategies (more on those later). Both of these support dynamic parameters (which might be denoted in other languages as <code>/post/&lt;title&gt;/info</code> or the like).</p>
<h3 id="dynamic-parameters-above-the-domain"><a class="header" href="#dynamic-parameters-above-the-domain">Dynamic Parameters Above the Domain</a></h3>
<p>One niche case is defining a route like this: <code>/&lt;locale&gt;/about</code>. In this case, the <code>about</code> template is rendered underneath a dynamic parameter. This is currently impossible in Perseus, but the most common reason to need it, internationalization (making your app work in many language), is support out-of-the-box with Perseus.</p>
<h3 id="different-templates-in-the-same-domain"><a class="header" href="#different-templates-in-the-same-domain">Different Templates in the Same Domain</a></h3>
<p>It's perfectly possible in Perseus to define one template for <code>/post</code> (and its children) and a different one for <code>/post/new</code>. In fact, this is exactly what <a href="https://github.com/arctic-hen7/perseus/tree/main/examples/showcase">the showcase example</a> does, and you can check it out for inspiration. This is based on a simple idea: <strong>more specific templates win</strong> the routing contest.</p>
<p>There is one use-case though that requires a bit more fiddling: having a different template for the root path. A very common use-case for this would be having one template for <code>/posts</code>'s children (one URl for each blog post) and a different template for <code>/posts</code> itself that lists all available posts. Currently, the only way to do this is to define a property on the <code>posts</code> template that will be <code>true</code> if you're rendering for that root, and then to conditionally render the list of posts. Otherwise, you would render the given post content. This does require a lot of <code>Option&lt;T&gt;</code>s, but they could be safely unwrapped (data passing in Perseus is logical and safe).</p>
<h2 id="checking-render-context"><a class="header" href="#checking-render-context">Checking Render Context</a></h2>
<blockquote>
<p>This feature is currently in development, the tracking issue is available <a href="https://github.com/arctic-hen7/perseus/issues/26">here</a>.</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../debugging.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../templates/metadata-modification.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../debugging.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../templates/metadata-modification.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
